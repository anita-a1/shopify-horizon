{% schema %}
{
  "name": "Registration Form",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Form Title",
      "default": "Create Account"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Form Subtitle",
      "default": "Join us"
    },
    {
      "type": "checkbox",
      "id": "show_password_requirements",
      "label": "Show Password Requirements",
      "default": true
    },
    {
      "type": "color",
      "id": "primary_color",
      "label": "Primary Color",
      "default": "#2563eb"
    },
    {
      "type": "color",
      "id": "success_color",
      "label": "Success Color",
      "default": "#10b981"
    },
    {
      "type": "color",
      "id": "error_color",
      "label": "Error Color",
      "default": "#dc2626"
    }
  ],
  "presets": [
    {
      "name": "Registration Form",
      "category": "Forms"
    }
  ]
}

{% endschema %}

<style>
/* Dynamic Colors from Schema */
.registration-form-section {
  --primary-color: {{ section.settings.primary_color }};
  --success-color: {{ section.settings.success_color }};
  --error-color: {{ section.settings.error_color }};
}
</style>


<div class="registration-form-section">
  <div class="page-width">
    <div class="registration-form-container">
      <div class="form-header">
        <h2 class="registration-title">{{ section.settings.title }}</h2>
        {% if section.settings.subtitle != blank %}
          <p class="registration-subtitle">{{ section.settings.subtitle }}</p>
        {% endif %}
      </div>
      
      <form id="registrationForm" class="registration-form" novalidate>
        <div class="form-row">
          <div class="form-group">
            <label for="firstName" class="form-label">First Name *</label>
            <input 
              type="text" 
              id="firstName" 
              name="firstName" 
              class="form-input" 
              required
              autocomplete="given-name"
              placeholder="Enter your first name"
            >
            <span class="error-message" id="firstNameError"></span>
          </div>
          
          <div class="form-group">
            <label for="lastName" class="form-label">Last Name *</label>
            <input 
              type="text" 
              id="lastName" 
              name="lastName" 
              class="form-input" 
              required
              autocomplete="family-name"
              placeholder="Enter your last name"
            >
            <span class="error-message" id="lastNameError"></span>
          </div>
        </div>
        
        <div class="form-group">
          <label for="email" class="form-label">Email Address *</label>
          <input 
            type="email" 
            id="email" 
            name="email" 
            class="form-input" 
            required
            autocomplete="email"
            placeholder="your@email.com"
          >
          <span class="error-message" id="emailError"></span>
        </div>
        
        <div class="form-group">
          <label for="password" class="form-label">Password *</label>
          <div class="password-input-wrapper">
            <input 
              type="password" 
              id="password" 
              name="password" 
              class="form-input" 
              required
              autocomplete="new-password"
              placeholder="Create a strong password"
            >
            <button type="button" class="password-toggle" aria-label="Toggle password visibility">
              <svg class="eye-icon eye-open" width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z" stroke="currentColor" stroke-width="2"/>
                <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
              </svg>
              <svg class="eye-icon eye-closed" width="20" height="20" viewBox="0 0 24 24" fill="none" style="display: none;">
                <path d="M2 2L22 22M9.88 9.88C9.34 10.42 9 11.17 9 12C9 13.66 10.34 15 12 15C12.83 15 13.58 14.66 14.12 14.12M3 12C3 12 5.91 6.91 12 6.91C13.59 6.91 15.09 7.29 16.5 7.94L21 3.5M21 12C21 12 18.09 17.09 12 17.09C10.41 17.09 8.91 16.71 7.5 16.06L3 20.5" stroke="currentColor" stroke-width="2"/>
              </svg>
            </button>
          </div>
          <span class="error-message" id="passwordError"></span>
          
          {% if section.settings.show_password_requirements %}
            <div class="password-requirements">
              <p class="requirements-title">Password must contain:</p>
              <ul class="requirements-list">
                <li id="req-length" class="requirement">
                  <span class="requirement-icon">•</span>
                  At least 8 characters
                </li>
                <li id="req-uppercase" class="requirement">
                  <span class="requirement-icon">•</span>
                  One uppercase letter
                </li>
                <li id="req-lowercase" class="requirement">
                  <span class="requirement-icon">•</span>
                  One lowercase letter
                </li>
                <li id="req-number" class="requirement">
                  <span class="requirement-icon">•</span>
                  One number
                </li>
                <li id="req-special" class="requirement">
                  <span class="requirement-icon">•</span>
                  One special character
                </li>
              </ul>
            </div>
          {% endif %}
        </div>
        
        <div class="form-group">
          <label for="confirmPassword" class="form-label">Confirm Password *</label>
          <div class="password-input-wrapper">
            <input 
              type="password" 
              id="confirmPassword" 
              name="confirmPassword" 
              class="form-input" 
              required
              autocomplete="new-password"
              placeholder="Confirm your password"
            >
            <button type="button" class="password-toggle" aria-label="Toggle password visibility">
              <svg class="eye-icon eye-open" width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z" stroke="currentColor" stroke-width="2"/>
                <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
              </svg>
              <svg class="eye-icon eye-closed" width="20" height="20" viewBox="0 0 24 24" fill="none" style="display: none;">
                <path d="M2 2L22 22M9.88 9.88C9.34 10.42 9 11.17 9 12C9 13.66 10.34 15 12 15C12.83 15 13.58 14.66 14.12 14.12M3 12C3 12 5.91 6.91 12 6.91C13.59 6.91 15.09 7.29 16.5 7.94L21 3.5M21 12C21 12 18.09 17.09 12 17.09C10.41 17.09 8.91 16.71 7.5 16.06L3 20.5" stroke="currentColor" stroke-width="2"/>
              </svg>
            </button>
          </div>
          <span class="error-message" id="confirmPasswordError"></span>
        </div>
        
        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" id="termsAccepted" name="termsAccepted" required>
            <span class="checkmark"></span>
            <span class="checkbox-text">
              I agree to the <a href="/pages/terms" target="_blank" class="link">Terms of Service</a> and <a href="/pages/privacy" target="_blank" class="link">Privacy Policy</a> *
            </span>
          </label>
          <span class="error-message" id="termsError"></span>
        </div>
        
        <div class="form-actions">
          <button type="submit" class="submit-button" id="submitBtn">
            <span class="button-text">Create Account</span>
            <span class="loading-spinner" style="display: none;">
              <svg width="20" height="20" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="31.416" stroke-dashoffset="31.416">
                  <animate attributeName="stroke-dashoffset" dur="2s" values="0;31.416" repeatCount="indefinite"/>
                </circle>
              </svg>
            </span>
          </button>
        </div>
        
        <div class="form-footer">
          <p class="login-link">
            Already have an account? <a href="/account/login" class="link">Sign in here</a>
          </p>
        </div>
      </form>
      
      <!-- Success Message -->
      <div id="successMessage" class="message success-message" style="display: none;">
        <div class="message-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="message-content">
          <h3>Account Created Successfully!</h3>
          <p>Welcome to our community! A verification email has been sent to your inbox.</p>
        </div>
      </div>
      
      <!-- Error Message -->
      <div id="errorMessage" class="message error-message" style="display: none;">
        <div class="message-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="message-content">
          <h3>Registration Failed</h3>
          <p id="errorText">Please check your information and try again.</p>
        </div>
      </div>
    </div>
  </div>
</div>

{{ 'registration-form.css' | asset_url | stylesheet_tag }}
<script src="{{ 'registration-form.js' | asset_url }}" defer></script>

<script>
  window.SHOP_DOMAIN = '{{ shop.domain }}';
document.addEventListener('DOMContentLoaded', function() {
  new RegistrationForm();
});
</script>